title: 实用统计学（五）
date: 2022-07-13 17:30:20
category:
- [Statistic,Theory]

tags: 
- Statistic
- R

toc: true
---

## 分类

### 朴素贝叶斯
条件概率
后验概率

<!--more-->

朴素贝叶斯是一种数据驱动的经验性方法，名字源于与贝叶斯规则类似的且用于预测的计算方式，更详细地说，就是在给定结果的情况下对预测值概率的初始计算，以及对结果概率的最终计算。
__贝叶斯分类器仅适用于分类预测变量__

将朴素贝叶斯用于数值型预测变量，需要采取下面两种方法之一。
- 将数值型预测变量划分为多个箱子，并转换为分类预测因子，然后再应用算法。
- 使用正态分布等概率模型，估计条件概率 。

如果训练数据中不存在预测因子类，那么在新数据中，算法会对结果变量赋予零概率。而其他一些方法会直接忽略该变量，并使用其他变量给出的信息。在对连续变量分箱时，需要注意这一点。


- 朴素贝叶斯要解答的问题是：“在每个结果类别中，哪些预测类别是最可能发生
的？”
- 该问题可以转化为，在给定预测值的情况下，估计结果属于不同类别的概率

### 判别分析

### 数值型预测变量
协方差
　　对一个变量相对于另一个变量的一致程度（幅度和方向类似）的度量。
　　协方差矩阵
　　协方差为正值表示正相关，为负值表示负相关
判别函数
　　当应用于预测变量上时，该函数可以使类之间的分离度最大化。
判别权重
　　应用判别函数得到的分值，用于估计记录属于某个类的概率。

费希尔线性判别法区分了组间变异性和组内变异性　
判别分析使用协方差矩阵计算线性判别函数，该函数用于区分属于不同类的记录。
线性判别函数对每个记录生成一个权重或分值（每个可能的类对应一个权重），以此来确定记录的估计类

### 逻辑回归

如何将一个二元结果变量转换为一种可以以线性方式建模的结果变量，然后再转换回二元结果变量？
Logit函数
逻辑响应函数


#### 广义线性模型
特征主要体现在下面两个方面。
- 一个概率分布或家族。例如，对于逻辑回归，它是二项分布。
- 一个将响应映射到预测因子的连接函数（linkfunction）。例如，对于逻辑回归，它是Logit 函数。

逻辑回归的优点
- 其所生成的模型无须重新计算，就可以快速地为新数据打分
- 与其他的分类方法相比，其所生成的模型易于解释。

多元线性回归和逻辑回归有许多共同点。它们都假设预测因子与响应之间存在线性参数的关联关系，并且都用类似的方式探索并发现最优模型。将模型概化为线性以使用预测因子的样条转换方法，同样适用于逻辑回归。但是，逻辑回归在以下两方面存在根本差异。
- 模型的拟合方式。逻辑回归不适用最小二乘法。
- 模型残差的性质和分析方法。

逻辑回归并不存在一种封闭的解决方案，模型必须使用最大似然估计（MLE）拟合。
最大似然估计试图找出一种最有可能生成所见数据的模型。在逻辑回归方程中，响应并非0或1，而是对响应为1的对数几率的估计
最大似然估计可以找出一种解决方案，使估计的对数几率能最优地描述所观测到的结果。最大似然估计算法中使用了拟牛顿优化法，该机制根据当前的参数值，在打分步骤（即费希尔分值）间迭代，逐步更新参数值，以改进模型的拟合度


### 模型评估
模型对新数据的分类准确程度。回归系数，R 还会将回归系数的标准误差、z 值和 p 值

#### 评估分类模型
概念|定义
---|---
正确率（accuracy）|正确分类的百分比（或比例）。
混淆矩阵|按预测分类和实际分类情况对记录分别计数，将计数结果以表格形式显示。例如，对于二元变量使用的是 2×2 的表格。
灵敏度|在预测结果中，1 被正确分类的百分比（或比例）。召回率（recall）
特异性|在预测结果中，0 被正确分类的百分比（或比例）。
准确率（precision）|预测结果为 1、真实值也为 1 的百分比（或比例）
ROC 曲线|灵敏度与特异性的绘图。召回率和特异性之间存在着权衡，ROC是用于捕获这种权衡的度量，“受试者工作特征”曲线
AUC|ROC 曲线下的总面积。AUC 的值越大，分类器越有效。如果 AUC 为 1，表示一个完美的分类器：将所有1正确分类，且没有任何 0被误分类为 1。
提升（lift）|在不同截止概率的情况下，衡量模型在识别（相对罕见的）1上的有效性
　　
### 不平衡数据的处理策略
概念|定义
---|---
欠采样|在分类模型中，使用更少的多数类记录。（下采样）
过采样|在分类模型中，更多地使用稀有类记录。必要时可以使用自助法。上采样
上权重、下权重|在模型中，对稀有类赋予更大的权重，对多数类赋予更小的权重。
数据生成|类似于自助法，只是每个新的自助记录与原记录略有不同。
z 分数|对结果做归一化所生成的值。
K|在最近邻计算中使用的近邻个数。